{% load static %}
{% load thumbnail %}
{% if product %}
<article class="bg-white rounded-lg shadow-lg overflow-hidden max-w-lg w-full h-full flex flex-col" data-detail-url="{% url 'product-detail' product.id %}">
  <div class="relative overflow-hidden bg-gray-200 aspect-square">
    {% thumbnail product.image "card_detail_img" as thumb %}
      <img src="{{ thumb.url}}" alt="{{ product.name }}" class="w-full h-full object-cover" loading="lazy" />
    <button
      class="favorite-btn absolute top-2 right-2 bg-black/30 p-2 rounded-full shadow hover:bg-black/40 transition"
      data-url="{% url 'toggle-favorite' product.id %}"
      data-product-id="{{ product.id }}"
      aria-label="Toggle favorite">
      {% if product.id in request.wishlist %}
      <i class="bi bi-heart-fill text-red-500"></i>
      {% else %}
      <i class="bi bi-heart text-white"></i>
      {% endif %}
    </button>
  </div>
  <div class="p-6 flex flex-col flex-grow">
    <h2 class="text-xl font-semibold mb-2 text-gray-800">{{ product.name }}</h2>
    <p class="text-gray-600 text-sm mb-3 flex-grow">{{ product.description }}</p>
    <p class="text-2xl font-bold text-green-600 mb-4">Ar {{ product.price }}</p>
    <hr class="my-3 text-gray-200" />
    <div class="flex gap-2 mt-auto">
      <button
        class="add-cart-btn primary-btn flex-1 flex items-center justify-center gap-2 transition"
        data-url="{% url 'add-to-cart' product.id %}"
        aria-label="Add {{ product.name }} to cart">
        <i class="bi bi-cart-plus"></i> <span class="text-sm sm:text-base">Add to Cart</span>
      </button>
    </div>
  </div>
</article>
<script src="{% static 'js/utils.js' %}"></script>
<script src="{% static 'js/products.js' %}"></script>
{% endif %}
