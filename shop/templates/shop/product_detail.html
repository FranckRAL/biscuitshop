{% load static %}
{% load cloudinary %}
{% if product %}
<article class="group bg-white rounded-4xl shadow-sm hover:shadow-xl border border-amber-100 overflow-hidden max-w-lg w-full h-full flex flex-col transition-all duration-300" data-detail-url="{% url 'product-detail' product.id %}">
  
  <div class="relative overflow-hidden bg-amber-50 aspect-square">
      <img src="{{product.image.url}}" alt="{{product.name}}" 
           class="h-full w-full object-cover transition-transform duration-500 group-hover:scale-110" 
           loading="lazy" />
      
      <button
        class="favorite-btn absolute top-4 right-4 bg-white/80 backdrop-blur-sm p-2.5 rounded-full shadow-md hover:bg-white transition-all active:scale-90"
        data-url="{% url 'toggle-favorite' product.id %}"
        data-product-id="{{ product.id }}"
        aria-label="Toggle favorite">
        {% if product.id in request.wishlist %}
        <i class="bi bi-heart-fill text-red-500"></i>
        {% else %}
        <i class="bi bi-heart text-amber-900"></i>
        {% endif %}
      </button>

      <div class="absolute bottom-4 left-4">
          <span class="bg-amber-500/90 text-white text-[10px] font-bold px-3 py-1 rounded-full uppercase tracking-widest backdrop-blur-sm">
              Artisanal
          </span>
      </div>
  </div>

  <div class="p-6 flex flex-col flex-grow bg-gradient-to-b from-white to-amber-50/30">
    <h2 class="text-xl font-bold mb-2 text-amber-900 group-hover:text-amber-600 transition-colors">{{ product.name }}</h2>
    
    <p class="text-amber-800/70 text-sm mb-4 line-clamp-2 flex-grow">
        {{ product.description }}
    </p>
    
    <div class="flex items-center justify-between mb-5">
        <p class="text-2xl font-black text-amber-600">
            <span class="text-sm font-medium text-amber-800/50 mr-1">Ar</span>{{ product.price }}
        </p>
        <div class="flex text-amber-400 text-xs">
            <i class="bi bi-star-fill"></i>
            <i class="bi bi-star-fill"></i>
            <i class="bi bi-star-fill"></i>
            <i class="bi bi-star-fill"></i>
            <i class="bi bi-star-half"></i>
        </div>
    </div>

    <div class="flex gap-2 mt-auto">
      <button
        class="add-cart-btn w-full bg-amber-600 hover:bg-amber-700 text-white font-bold py-3 rounded-xl flex items-center justify-center gap-2 transition-all shadow-md hover:shadow-amber-200 active:scale-95"
        data-url="{% url 'add-to-cart' product.id %}"
        aria-label="Add {{ product.name }} to cart">
        <i class="bi bi-cart-plus text-lg"></i>
        <span class="text-sm sm:text-base uppercase tracking-wider">Add to Cart</span>
      </button>
    </div>
  </div>
</article>

<script src="{% static 'js/utils.js' %}"></script>
<script src="{% static 'js/products.js' %}"></script>
{% endif %}